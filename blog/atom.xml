<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://aerospike.github.io/skyhook/blog</id>
    <title>Skyhook Blog</title>
    <updated>2021-08-30T00:00:00.000Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://aerospike.github.io/skyhook/blog"/>
    <subtitle>Skyhook Blog</subtitle>
    <icon>https://aerospike.github.io/skyhook/img/favicon.ico</icon>
    <entry>
        <title type="html"><![CDATA[Introducing Skyhook]]></title>
        <id>https://aerospike.github.io/skyhook/blog/introducing-skyhook</id>
        <link href="https://aerospike.github.io/skyhook/blog/introducing-skyhook"/>
        <updated>2021-08-30T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[https://dev.to/aerospike/skyhook-a-redis-compatible-interface-to-aerospike-database-4hjj]]></summary>
        <content type="html"><![CDATA[<blockquote><p><em><a href="https://dev.to/aerospike/skyhook-a-redis-compatible-interface-to-aerospike-database-4hjj" target="_blank" rel="noopener noreferrer">https://dev.to/aerospike/skyhook-a-redis-compatible-interface-to-aerospike-database-4hjj</a></em></p></blockquote><p><a href="https://www.aerospike.com/" target="_blank" rel="noopener noreferrer">Aerospike</a> is a highly available and scalable NoSQL distributed database used in production to provide blazingly fast performance at Petabyte scale. Production deployments of Aerospike are almost always serving their data from NVMe drives, though it’s possible to run namespaces in memory.</p><p>Redis is a well loved key-value data store that is widely used by developers, which was designed to run single node (single-threaded originally) and in-memory.
This article might be interesting to developers who are using <a href="https://redis.io/" target="_blank" rel="noopener noreferrer">Redis</a> and looking for more scalable and highly available alternatives, or maybe already have some applications running on Aerospike.</p><p>Migrating to a different technology is always a challenging process. You need to train engineers, rewrite the codebase, and set up a production cluster to take over. Using <a href="https://github.com/aerospike/skyhook" target="_blank" rel="noopener noreferrer">Skyhook</a>, you can move applications to Aerospike first, then come back to rewrite them as Aerospike native, or if you’re satisfied with their performance, keep them as they are.
Or maybe you’re looking to expose your Aerospike data to external Redis-based applications? We would love to hear how you would use this project.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="skyhook-to-the-rescue">Skyhook to the rescue<a href="#skyhook-to-the-rescue" class="hash-link" aria-label="Direct link to Skyhook to the rescue" title="Direct link to Skyhook to the rescue">​</a></h2><p>We, as a company, observed this need and came up with the highly performant bridge service, which acts as a fully-fledged (with commands support limitation) Redis server, bridging the clients’ commands to Aerospike clusters.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="technical-details">Technical details<a href="#technical-details" class="hash-link" aria-label="Direct link to Technical details" title="Direct link to Technical details">​</a></h2><p>Skyhook is a standalone server application written in Kotlin, which projects Redis protocol commands to an Aerospike cluster using the Aerospike Java client under the hood. The server supports a single namespace and set configuration, where the incoming commands will be applied. This project uses <a href="https://netty.io/" target="_blank" rel="noopener noreferrer">Netty</a> as a non-blocking I/O client-server framework.</p><p>Netty, is a highly performant JVM asynchronous event-driven network application framework. Its customizable thread model and native transport support forge an incredibly performant network communication layer.</p><p>What’s left is to translate Redis commands to Aerospike commands, and here come the async capabilities of the Aerospike Java Client.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="installation-and-configuration">Installation and configuration<a href="#installation-and-configuration" class="hash-link" aria-label="Direct link to Installation and configuration" title="Direct link to Installation and configuration">​</a></h2><p>You will need JDK8 and an Aerospike Server version &gt;= 4.9 because Skyhook uses the new scan capabilities which are available starting from that version.</p><p>Clone <a href="https://github.com/aerospike/skyhook" target="_blank" rel="noopener noreferrer">aerospike/skyhook</a> or grab a prebuilt executable JAR from the <a href="https://github.com/aerospike/skyhook/releases" target="_blank" rel="noopener noreferrer">releases</a> to get started.</p><p>To build the service from the sources:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">./gradlew clean build</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This command will build an executable JAR file.</p><p>Skyhook is configured using a configuration file, and it’s in YAML format. You will need to specify it using the <code>-f</code> flag.</p><p>To run the server:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">java -jar skyhook-[version]-all.jar -f config/server.yml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>An example configuration file can be found in the config folder under the project repository.</p><p>Here are the current configuration properties available.</p><table><thead><tr><th>Property name</th><th>Description</th><th>Default value</th></tr></thead><tbody><tr><td>hostList</td><td>The host list to seed the Aerospike cluster.</td><td>localhost:3000</td></tr><tr><td>namespace</td><td>The Aerospike namespace.</td><td>test</td></tr><tr><td>set</td><td>The Aerospike set name.</td><td>redis</td></tr><tr><td>bin</td><td>The Aerospike bin name to set values.</td><td>b</td></tr><tr><td>redisPort</td><td>The server port to bind to.</td><td>6379</td></tr><tr><td>workerThreads<sup>1</sup></td><td>The Netty worker group size.</td><td>number of available cores</td></tr><tr><td>bossThreads</td><td>The Netty acceptor group size.</td><td>2</td></tr></tbody></table><sup>1</sup> `workerThreads` property is used to configure the size of the Aerospike Java Client EventLoops as well.<p><code>workerThreads</code> and <code>bossThreads</code> are the Netty thread pool sizes and can be easily fine-tuned for optimal performance.
After the server is up and running, any Redis client can connect to it as if it were a regular Redis server.</p><p>For the test purposes you can use redis-cli or even the nc (or netcat) utility:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">echo "GET key1\r\n" | nc localhost 6379</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="benchmarking">Benchmarking<a href="#benchmarking" class="hash-link" aria-label="Direct link to Benchmarking" title="Direct link to Benchmarking">​</a></h2><p>From the very beginning, the project was built with an attention to performance, and the results speak for themselves.</p><p>Running this Redis benchmark:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">redis-benchmark -t set -r 100000 -n 1000000</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We had the following results on local Skyhook with a single-node default configuration Aerospike cluster on Docker:</p><blockquote><p><em>Summary:</em><br>
<em>throughput summary: 13453.88 requests per second</em><br>
<em>latency summary (msec):</em><br>
<em>avg       min       p50       p95       p99    max</em><br>
<em>3.627     0.864     3.263     5.583     7.463  1012.223</em></p></blockquote><p>While those were the results for the Redis node running on Docker:</p><blockquote><p><em>Summary:</em><br>
<em>throughput summary: 14967.15 requests per second</em><br>
<em>latency summary (msec):</em><br>
<em>avg       min       p50       p95       p99    max</em><br>
<em>3.275     0.608     2.935     5.087     6.679  1006.591</em></p></blockquote><p>You can see that they are really close. More than that, we can multiply the number of the Skyhook nodes and significantly improve performance working with the same aerospike cluster. For instance, you can use the Round-robin DNS or any popular load balancer like HAProxy. This will not require any specific configuration since Skyhook is completely stateless.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="summary">Summary<a href="#summary" class="hash-link" aria-label="Direct link to Summary" title="Direct link to Summary">​</a></h2><p>The project is constantly evolving, having more and more commands being supported. You can find the coverage of the supported Redis commands in the <a href="https://github.com/aerospike/skyhook" target="_blank" rel="noopener noreferrer">repo readme</a>.</p><p>It will be really great to hear from you about the experience of using it. Also, your contributions to the project are very welcome.</p><p>If you encounter a bug, please report it or <a href="https://github.com/aerospike/skyhook/issues" target="_blank" rel="noopener noreferrer">open an issue</a> stating the commands you would like to be supported.</p>]]></content>
        <category label="skyhook" term="skyhook"/>
        <category label="redis" term="redis"/>
        <category label="aerospike" term="aerospike"/>
    </entry>
</feed>